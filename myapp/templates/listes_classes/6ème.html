{% extends 'base.html' %}

{% block title %} Liste des √©l√®ves de la 6√®me {% endblock title %}

{% block content %}
<nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm rounded mb-4">
    <div class="container-fluid">
        <!-- Logo / Nom de l'√©cole -->
        <a class="navbar-brand fw-bold" href="{% url 'accueil' %}">{{ school_name }}</a>

        <!-- Toggle bouton pour mobile -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Dropdowns et bouton -->
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto align-items-center">
                <!-- Trimestre 1 -->
                <li class="nav-item dropdown me-2">
                    <a class="nav-link dropdown-toggle" href="#" id="trimestre1Dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Trimestre 1
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="trimestre1Dropdown">
                        <li><a class="dropdown-item" href="{% url 'trimestre_1' classe=classe annee_academique=annee_academique %}">T√©l√©charger PDF</a></li>
                        <li><a class="dropdown-item" href="{% url 'trimestre1_excel' classe=classe annee_academique=annee_academique %}">T√©l√©charger Excel</a></li>
                    </ul>
                </li>

                <!-- Trimestre 2 -->
                <li class="nav-item dropdown me-2">
                    <a class="nav-link dropdown-toggle" href="#" id="trimestre2Dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Trimestre 2
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="trimestre2Dropdown">
                        <li><a class="dropdown-item" href="{% url 'trimestre_2' classe=classe annee_academique=annee_academique %}">T√©l√©charger PDF</a></li>
                        <li><a class="dropdown-item" href="{% url 'trimestre2_excel' classe=classe annee_academique=annee_academique %}">T√©l√©charger Excel</a></li>
                    </ul>
                </li>

                <!-- Trimestre 3 -->
                <li class="nav-item dropdown me-3">
                    <a class="nav-link dropdown-toggle" href="#" id="trimestre3Dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        Trimestre 3
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="trimestre3Dropdown">
                        <li><a class="dropdown-item" href="{% url 'trimestre_3' classe=classe annee_academique=annee_academique %}">T√©l√©charger PDF</a></li>
                        <li><a class="dropdown-item" href="{% url 'trimestre3_excel' classe=classe annee_academique=annee_academique %}">T√©l√©charger Excel</a></li>
                    </ul>
                </li>

                <!-- Bouton G√©n√©rer cartes -->
                <li class="nav-item">
                    <a href="{% url 'generer_cartes_pdf' classe=classe annee_academique=annee_academique %}" 
                       class="btn btn-success btn-sm">
                       üÜî G√©n√©rer cartes
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="welcome-text">
  Liste des √©l√®ves de la <span class="text-primary">6√®me</span>
  <form id="annee-form" method="GET" class="d-flex justify-content-center mt-4">
    <div class="input-group" style="max-width: 300px;">
        <input type="text" name="annee" class="form-control" placeholder="Ex: 2024-2025" value="">
        <button class="btn btn-primary" type="submit">Valider</button>
    </div>
</form>
<a href="{% url 'liste_eleves' classe=classe annee_academique=annee_academique %}" class="btn btn-default">Liste des √©l√®ves</a>
<a href="{% url 'fiche_notes_detail' classe=classe annee_academique=annee_academique %}" 
   class="btn btn-default">
   üìÑ Voir les notes
</a>
<a href="{% url 'fiche_note' classe=classe annee_academique=annee_academique %}" class="btn btn-default">Fiche de notes</a>
</div>
<div class="text-center mb-3">
    <a href="{% url 'inserer_notes_classe' classe=classe annee_academique=annee_academique %}" 
       class="btn btn-info btn-lg">
       üìù Ins√©rer les notes
    </a>
    </div>
    <div class="text-center mb-3">
        <p>Choisissez le trimestre - Envoi des r√©sultats :</p>
        <div class="btn-group" role="group">
            <a href="{% url 'envoyer_sms_notes' classe=classe annee_academique=annee_academique %}?trimestre=1"
               class="btn btn-outline-primary btn-lg">
               Trimestre 1
            </a>
            <a href="{% url 'envoyer_sms_notes' classe=classe annee_academique=annee_academique %}?trimestre=2"
               class="btn btn-outline-primary btn-lg">
               Trimestre 2
            </a>
            <a href="{% url 'envoyer_sms_notes' classe=classe annee_academique=annee_academique %}?trimestre=3"
               class="btn btn-outline-primary btn-lg">
               Trimestre 3
            </a>
        </div>
    </div>
    

<table class="table table-striped table-bordered">
<thead class="table-dark"> 
  <tr>
    <th class="text text-center">N¬∞</th> 
    <th class="text text-center">Photo de l'√©l√®ve</th>
    <th class="text text-center">Nom &nbsp et &nbsp Pr√©noms </th>
    <th class="text text-center">Sexe</th>
    <th class="text text-center">Ann√©e acad√©mique</th>
    <th class="text text-center">T√©l√©charger le bulletin</th>
    <th class="text text-center">Actions</th>
  </tr>
</thead>
<tbody>
  {% for eleve in eleves %}
  <tr>
      <td class="text text-center"><a style="color:black;" href="{% url 'modifier_eleve' annee=annee_academique classe=eleve.classe eleve_id=eleve.id %}">{{ forloop.counter }}</a></td>
      <td class="text text-center">
        {% if eleve.profile_eleve %}
            <img src="{{ eleve.profile_eleve.url }}" alt="Photo de {{ eleve.nom }}" class="photo-eleve">
        {% else %}
            <span>Aucune photo</span>  <!-- Affiche un message si aucune photo n'est disponible -->
        {% endif %}
    </td>          
      <td class="text text-center">{{ eleve.nom }}&nbsp&nbsp{{ eleve.prenoms }}</td>
      <td class="text text-center">{{ eleve.sexe }}</td>
      <td class="text text-center">{{ eleve.annee_academique }}</td>
      <td>
        <div class="d-flex justify-content-center">
        <button class="btn btn-default btn-sm"><a href="{% url 'trimestre1' classe=eleve.classe eleve_id=eleve.id %}" style="color:black; font-size:14px; font-weight:bold;">Trimestre 1</a></button>
        <button class="btn btn-default btn-sm"><a href="{% url 'trimestre2' classe=eleve.classe eleve_id=eleve.id %}"  style="color:black; font-size:14px; font-weight:bold;">Trimestre 2</a></button>
        <button class="btn btn-default btn-sm"><a href="{% url 'trimestre3' classe=eleve.classe eleve_id=eleve.id %}"  style="color:black; font-size:14px; font-weight:bold;">Trimestre 3</a></button>
        </div>
      </td>
      <td>
        <div class="d-flex justify-content-center">
            <a href="{% url 'choisir_trimestre_sms' eleve_id=eleve.id %}" class="btn btn-secondary btn-sm">
         üì© Envoyer les notes aux parents
     </a>
<button class="btn btn-danger btn-sm"><a href="{% url 'supprimer_eleve' eleve.id %}"onclick="return confirm('√ätes-vous s√ªr de vouloir supprimer cet √©l√®ve ?');">supprimer l'√©l√®ve</a></button>
      </div>
    </div>
      </td>
    </tr>
  {% endfor %}
</tbody>
</table>
{% endblock content %}
